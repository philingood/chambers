#include "hol3.h"

/*------------------------------------------------------*/
/*          вычисление газовой постоянной от            */
/*      номера топлива и к-та избытка окислителя        */
/*------------------------------------------------------*/

double Rgc(int ii)
{
/* затабулирована зависимость R от избытка окислителя */
double a[][17]=
        {
	{520.,472.,443.,405.,380.,352.,340.,325.,315.,311.,306.},
	{520.,480.,454.,412.,376.,352.,335.,327.,318.,316.,313.},
	{540.,505.,452.,410.,372.,350.,330.,320.,315.},
	{595.,570.,491.,448.,412.,385.,367.,353.,342.,335.,331.},
	{532.,480.,440.,408.,373.,348.,331.,320.,316.,313.,300.},
	{540.,494.,450.,400.,374.,350.,330.,320.,317.,314.,311.},
	{610.,560.,500.,450.,420.,395.,375.,360.,355.,340.,335.,325.,318.,310.,308.},
	{600.,550.,487.,440.,408.,380.,360.,348.,340.,330.,322.,316.,313.,300.,296.,290.,284.},
	{628.,560.,505.,460.,428.,400.,384.,370.,358.},
	{540.,520.,490.,440.,400.,380.,360.,348.,340.,332.,326.,313.,305.,296.,290.},
	{640.,570.,510.,430.,390.,360.,340.,329.,320.,312.,305.,292.,285.,280.,275.,270.,268.},
	{629.,637.,598.,519.,462.,422.,395.,375.,360.,349.,339.,324.,313.,305.,298.,289.,283.},
	{620.,580.,495.,420.,383.,360.,347.,333.,321.,312.,306.,295},
	{645.,595.,530.,475.,440.,412.,387.,374.,362.,350.,346.,330.,320.,310.,300.},
	{1600,1200,960.,850.,750.,650.,600.,560.,520.,500.,480.,450.,420.,400.,380.,360.,350.},
	{950.,825.,725.,650.,600.,550.,525.,502.,482.,475.,455.,445.,430.,425.,425.},
	{620.,550.,500.,470.,440.,420.,410.,400.,395.,390.,386.,381.,380.,378.,376.}
	};
int ns[]={11,11,9,11,11,11,14,16,9,14,16,12,12,14,16,14,12};
double alphs[]={0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.,1.1,1.2,1.4,1.6,1.8,2.,2.4,2.8};
double ret;

if(ii==-1)
	ret=cs_sp(ns[i1],alphs,a[i1],Aok1);
else
	ret=cs_sp(ns[i1],alphs,a[i1],Aok[ii]);

if(ret < 268.) ret = 268.;
if(ret > 1600.) ret = 1600.;

return ret;
}

/******************************************************************/
/*       вычисление комплекса S от номера топлива, температуры    */
/*              и коэффициента избытка окислителя                 */
/******************************************************************/

static double   S1(int),S2(int),S3(int),S4(int),S5(int),S6(int),
		S7(int),S8(int),S9(int),S10(int),S11(int),
		S12(int),S13(int),S14(int),S15(int),
		S16(int),S17(int);

static double (*Sss[])(int)={S1,S2,S3,S4,S5,S6,S7,S8,S9,S10,
                       S11,S12,S13,S14,S15,S16,S17};

#define ANM	20

static double sol_SS(int ns, int pts, int tps, double ss[][ANM], double * alphs, double * temps)
{
double st[ANM];
int ii;
double ret;
for(ii=0;ii<tps;ii++)
	st[ii]=lin(pts,alphs,ss[ii],Aok[ns]);
ret=lin(tps,temps,st,Tct[ns]);

if(ret < 0.001) ret = 0.001;
if(ret > 11)	ret = 11;

return ret;
}

double SS(int ns)
{ return (*Sss[i1])(ns);}

static double S1(int ns)
{ /* АК + керосин Т-1 */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.15,0.2 ,0.25,0.3 ,0.35,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
/* первый индекс - избыток окислителя, второй - температура */
/* каждая строка - при одной температуре и разных Aok */
{1.40,1.45,1.55,1.75,2.10,2.5 ,3.74,4.50,5.05,5.51,5.92,6.20,6.25,6.05,5.80,5.35},
{1.16,1.20,1.25,1.5 ,1.78,2.24,3.45,4.24,4.75,5.25,5.70,5.90,6.  ,5.85,5.6 ,5.15},
{0.85,0.95,1.03,1.13,1.5 ,1.98,3.03,3.9 ,4.5 ,5.  ,5.47,5.71,5.76,5.6 ,5.28,4.85},
{0.74,0.75,0.80,1   ,1.26,1.65,2.75,3.56,4.24,4.75,5.21,5.45,5.5 ,5.28,5.1 ,4.15},
{0.5 ,0.52,0.6 ,0.78,1.02,1.45,2.5 ,3.3 ,4.  ,4.48,4.94,5.2 ,5.25,5.05,4.85,4.4 },
{0.28,0.30,0.42,0.55,0.85,1.2 ,2.25,3.05,3.74,4.25,4.74,4.94,5.08,4.82,4.62,4.22},
{0.05,0.07,0.11,0.35,0.65,0.99,2   ,2.78,3.48,4.  ,4.48,4.72,4.77,4.6 ,4.42,3.98},
{0   ,0   ,0   ,0.15,0.45,0.75,1.75,2.5 ,3.2 ,3.75,4.25,4.48,4.52,4.33,4.21,3.75},
{0   ,0   ,0   ,0   ,0.25,0.51,1.5 ,2.3 ,2.97,3.5 ,4.  ,4.25,4.3 ,4.18,4.02,3.5 },
{0   ,0   ,0   ,0   ,0   ,0.27,1.29,2.1 ,2.75,3.26,3.77,4.02,4.15,4.  ,3.75,3.28},
{0   ,0   ,0   ,0   ,0   ,0.15,1.1 ,1.85,2.5 ,3.05,3.58,3.82,3.97,3.78,3.00,3.1 }
};
/* первое число - количество столбцов, второй - количество колонок */
return sol_SS(ns,16,11,ss,alphs,temps);
}

static double S2(int ns)
{/*АК+тонка*/
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.15,0.2 ,0.25,0.3 ,0.35,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
{1.62,1.7 ,1.8 ,1.98,2.25,2.8 ,3.78,4.72,5.5 ,5.65,6.  ,6.28,6.42,6.2 ,5.92,5.49},
{1.36,1.42,1.5 ,1.65,2.  ,2.5 ,3.5 ,4.38,4.95,5.28,5.74,5.98,6.15,5.97,5.72,5.25},
{1.08,1.12,1.22,1.32,1.65,2.24,3.24,4.  ,4.65,5.08,5.5 ,5.75,5.88,5.74,5.45,5.  },
{0.86,0.92,0.98,1.1 ,1.45,2.  ,3.  ,3.75,4.4 ,4.8 ,5.25,5.49,5.6 ,5.45,5.2 ,4.75},
{0.62,0.64,0.74,0.82,1.15,1.75,2.75,3.49,4.1 ,4.55,5.  ,5.24,5.4 ,5.25,4.99,4.52},
{0.41,0.48,0.5 ,0.66,0.95,1.5 ,2.48,3.23,3.78,4.27,4.75,4.99,5.15,4.96,4.7 ,4.25},
{0.25,0.28,0.3 ,0.46,0.75,1.25,2.21,3.  ,3.6 ,4.1 ,4.5 ,4.75,4.9 ,4.74,4.45,3.98},
{0.01,0.05,0.12,0.25,0.5 ,1.  ,1.92,2.72,3.33,3.78,4.25,4.5 ,4.71,4.49,4.25,3.73},
{0   ,0   ,0   ,0   ,0.25,1.86,1.75,2.5 ,3.17,3.6 ,4.  ,4.25,4.49,4.25,3.98,3.45},
{0   ,0   ,0   ,0   ,0.12,1.64,1.5 ,2.25,2.9 ,3.3 ,3.75,4.02,4.25,4.  ,3.72,3.3 },
{0   ,0   ,0   ,0   ,0   ,1.5 ,1.3 ,2.02,2.72,3.15,3.55,3.78,4.  ,3.75,3.4 ,2.79}
};

return sol_SS(ns,16,11,ss,alphs,temps);
}

static double S3(int ns)
{/*АК-27+тонка*/
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.15,0.2 ,0.25,0.3 ,0.35,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
{1.6 ,1.7 ,1.8 ,2.  ,2.4 ,2.9 ,3.9 ,4.75,5.32,5.8 ,6.3 ,6.5 ,6.62,6.5 ,6.3 ,5.48},
{1.27,1.4 ,1.5 ,1.73,2.01,2.52,3.7 ,4.48,5.0 ,5.53,6.05,6.25,6.35,6.27,6.1 ,5.3 },
{1.08,1.2 ,1.24,1.47,1.75,2.25,3.3 ,4.2 ,4.75,5.27,5.75,6.  ,6.1 ,6.05,5.8 ,5.12},
{0.8 ,0.95,1.  ,1.2 ,1.5 ,2.02,3.05,3.85,4.5 ,5.  ,5.5 ,5.74,5.86,5.77,5.68,4.88},
{0.6 ,0.75,0.75,0.98,1.27,1.8 ,2.77,3.6 ,4.25,4.75,5.25,5.5 ,5.68,5.55,5.4 ,4.75},
{0.42,0.5 ,0.52,0.74,1.04,1.55,2.53,3.32,4.  ,4.5 ,5.  ,5.25,5.37,5.3 ,5.23,4.5 },
{0.21,0.35,0.4 ,0.51,0.78,1.33,2.25,3.12,3.75,4.25,4.75,5.  ,5.2 ,5.11,4.9 ,4.26},
{0   ,0.1 ,0.15,0.3 ,0.58,1.16,2.  ,2.8 ,3.5 ,4.  ,4.51,4.75,4.88,4.85,4.74,4.  },
{0   ,0   ,0   ,0.1 ,0.46,1.  ,1.83,2.64,3.25,3.8 ,4.28,4.5 ,4.65,4.6 ,4.49,3.76},
{0   ,0   ,0   ,0   ,0.22,0.72,1.67,2.4 ,3.1 ,3.6 ,4.1 ,4.25,4.42,4.4 ,4.25,3.5 },
{0   ,0   ,0   ,0   ,0   ,0.5 ,1.49,2.24,2.82,3.4 ,3.83,4.05,4.21,4.2 ,4.  ,3.25}
};
return sol_SS(ns,16,11,ss,alphs,temps);
}


static double S4(int ns)
{
/* АК-27+НДМГ */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.15,0.2 ,0.25,0.3 ,0.35,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
{1.8 ,2.  ,2.25,2.5 ,3.  ,3.75,4.45,5.  ,5.47,5.78,6.25,6.5 ,6.62,6.35,6.11,5.75},
{1.5 ,1.7 ,1.85,2.24,2.75,3.4 ,4.05,4.7 ,5.18,5.55,6.01,6.12,6.27,6.02,5.77,5.42},
{1.25,1.45,1.6 ,1.95,2.48,3.05,3.75,4.32,4.8 ,5.23,5.75,6.  ,6.05,5.75,5.51,5.25},
{1.05,1.2 ,1.4 ,1.7 ,2.1 ,2.75,3.48,4.05,4.6 ,5.08,5.5 ,5.75,5.75,5.5 ,5.28,4.97},
{0.8 ,0.95,1.2 ,1.4 ,1.8 ,2.5 ,3.23,3.78,4.3 ,4.75,5.25,5.49,5.5 ,5.25,5.05,4.75},
{0.6 ,0.75,0.9 ,1.2 ,1.55,2.23,2.95,3.59,4.1 ,4.58,5.02,5.24,5.25,5.  ,4.78,4.48},
{0.35,0.5 ,0.75,0.95,1.28,1.98,2.73,3.28,3.78,4.27,4.75,5.  ,5.07,4.78,4.67,4.26},
{0.18,0.3 ,0.5 ,0.75,1.05,1.75,2.5 ,3.15,3.65,4.12,4.55,4.75,4.77,4.6 ,4.35,4.05},
{0.01,0.1 ,0.3 ,0.5 ,0.9 ,1.5 ,2.25,2.8 ,3.32,3.8 ,4.3 ,4.5 ,4.58,4.35,4.23,3.77},
{0   ,0   ,0.1 ,0.3 ,0.75,1.25,2.  ,2.65,3.18,3.68,4.17,4.28,4.32,4.15,3.95,3.62},
{0   ,0   ,0   ,0.15,0.5 ,1.08,1.8 ,2.4 ,2.8 ,3.35,3.8 ,4.12,4.23,4.  ,3.75,3.36}
};

return sol_SS(ns,16,11,ss,alphs,temps);
}

static double S5(int ns)
{ /* АК-40 + керосин */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.2 ,0.25,0.3 ,0.35,0.4 ,0.45,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
{1.25,1.5 ,1.78,2.22,2.6 ,3.98,4.5 ,4.75,5.35,5.78,6.35,6.53,6.62,6.45,6.  ,5.65},
{0.98,1.25,1.55,0.93,2.4 ,3.1 ,3.8 ,4.5 ,5.1 ,5.6 ,6.12,6.25,6.27,6.15,5.8 ,5.45},
{0.76,1.  ,1.27,1.66,2.05,2.75,3.5 ,4.2 ,4.76,5.28,5.77,6.  ,6.02,5.85,5.6 ,5.25},
{0.52,0.75,1.06,1.45,1.78,2.5 ,3.25,3.85,4.5 ,5.05,5.55,5.75,5.77,5.6 ,5.3 ,5.  },
{0.38,0.52,0.85,1.1 ,1.52,2.25,3.  ,3.6 ,4.25,4.78,5.3 ,5.5 ,5.52,5.4 ,5.12,4.75},
{0.12,0.37,0.62,0.99,1.35,2.  ,2.71,3.35,4.  ,4.52,4.8 ,5.25,5.28,5.15,4.8 ,4.53},
{0   ,0.13,0.46,0.75,1.1 ,1.75,2.45,3.07,3.75,4.31,4.78,5.05,5.1 ,4.9 ,4.72,4.3 },
{0   ,0   ,0.25,0.5 ,0.92,1.5 ,2.23,2.8 ,3.51,4.15,4.65,4.77,4.81,4.7 ,4.45,4.12},
{0   ,0   ,0.02,0.4 ,0.75,1.28,1.99,2.6 ,3.3 ,3.82,4.4 ,4.58,4.62,4.5 ,4.28,3.9 },
{0   ,0   ,0   ,0.26,0.55,1.05,1.75,2.4 ,3.1 ,3.65,4.2 ,4.4 ,4.43,4.25,4.05,3.75},
{0   ,0   ,0   ,0   ,0.4 ,0.9 ,1.5 ,2.24,2.8 ,3.42,3.99,4.18,4.2 ,4.03,3.8 ,3.5 }
};

return sol_SS(ns,16,11,ss,alphs,temps);
}

static double S6(int ns)
{
/* АК-40 + тонка */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.2 ,0.25,0.3 ,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,0.95,1.  ,1.05,1.1 ,1.2 };
double ss[][ANM]={
{1.55,1.73,2.  ,2.99,4.02,5.  ,5.5 ,6.  ,6.5 ,6.65,6.8 ,6.4 ,6.  ,5.8 },
{1.25,1.45,1.74,2.7 ,3.73,4.62,5.2 ,5.75,6.2 ,6.27,6.65,6.22,5.85,5.5 },
{1.05,1.2 ,1.48,2.4 ,3.47,4.3 ,4.92,5.5 ,5.92,6.05,6.3 ,6.0 ,5.7 ,5.2 },
{0.78,0.9 ,1.22,2.1 ,3.11,4.01,4.65,5.26,5.7 ,5.78,6.1 ,5.75,5.49,5.03},
{0.58,0.74,0.99,1.85,2.9 ,3.75,4.31,5.1 ,5.42,5.55,5.78,5.5 ,5.27,4.9 },
{0.44,0.52,0.76,1.6 ,2.62,3.5 ,4.1 ,4.8 ,5.24,5.3 ,5.6 ,5.28,5.1 ,4.75},
{0.25,0.37,0.55,1.4 ,2.4 ,3.24,3.78,4.58,5.  ,5.1 ,5.4 ,5.15,4.8 ,4.55},
{0.05,0.12,0.4 ,1.2 ,2.17,3.  ,3.65,4.27,4.75,4.85,5.13,4.9 ,4.75,4.35},
{0   ,0   ,0.25,1.  ,2.  ,2.76,3.4 ,4.1 ,4.5 ,4.6 ,4.82,4.7 ,4.45,4.12},
{0   ,0   ,0   ,0.75,1.75,2.55,3.21,3.75,4.24,4.4 ,4.73,4.48,4.25,3.85},
{0   ,0   ,0   ,0.6 ,1.5 ,2.37,2.98,3.58,4.05,4.25,4.5 ,4.27,4.  ,3.7 },
};
return sol_SS(ns,14,11,ss,alphs,temps);
}

static double S7(int ns)
{ /* N2O4 + ММГ */
double temps[]={600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,1.  ,1.1 ,1.2 ,1.4 ,1.6 ,1.8 ,2.0 };
double ss[][ANM]={
{1.42,2.99,3.92,4.4 ,5.  ,5.55,6.9 ,6.5 ,6.9 ,6.5 ,6.2 ,5.5 ,4.99,4.5 ,4.2 },
{1.27,2.7 ,3.6 ,4.2 ,4.75,5.3 ,6.7 ,6.25,6.7 ,6.25,5.83,5.25,4.75,4.3 ,3.93},
{1.05,2.48,3.47,3.98,4.5 ,5.08,6.4 ,6.  ,6.4 ,6.  ,5.67,5.05,4.52,4.1 ,3.75},
{0.75,2.25,3.1 ,3.7 ,4.25,4.88,6.2 ,5.75,6.2 ,5.75,5.45,4.8 ,4.38,3.8 ,3.5 },
{0.58,2.  ,2.93,3.47,4.  ,4.62,5.96,5.52,5.96,5.52,5.2 ,4.6 ,4.12,3.6 ,3.28},
{0.4 ,1.75,2.75,3.22,3.78,4.41,5.73,5.28,5.73,5.28,4.98,4.35,3.85,3.48,3.07},
{0.2 ,1.55,2.5 ,2.95,3.5 ,4.25,5.5 ,5.05,5.5 ,5.05,4.75,4.2 ,3.68,3.24,2.88},
{0   ,1.45,2.29,2.75,3.28,3.9 ,5.25,4.8 ,5.25,4.8 ,4.5 ,3.9 ,3.48,3.05,2.72},
{0   ,1.2 ,2.03,2.5 ,3.1 ,3.73,5.1 ,4.65,5.1 ,4.65,4.29,3.71,3.25,2.85,2.5 },
{0   ,0.8 ,1.8 ,2.28,2.8 ,3.48,4.78,4.42,4.78,4.42,4.1 ,3.5 ,3.1 ,2.72,2.35}
};

return sol_SS(ns,15,10,ss,alphs,temps);
}

static double S8(int ns)
{ /* N2O4 + НДМГ */
double temps[]={500,600,800,1000,1200,1400,1600,1800,2000};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.3 ,1.6 ,1.9 ,2.2 ,2.5 ,2.8 };
double ss[][ANM]={
{2.74,2.78,3.75,5.5 ,6.5 ,7.45,6.  ,5.15,4.5 ,4.  ,3.5 ,3.15},
{2.47,2.52,3.5 ,5.  ,6.2 ,4.2 ,5.82,4.85,4.27,3.78,3.33,3.08},
{1.80,2.05,3.  ,4.5 ,5.7 ,6.7 ,5.5 ,4.6 ,4.  ,3.47,3.05,2.7 },
{1.25,1.6 ,2.52,4.  ,5.22,6.53,5.  ,4.2 ,3.53,3.1 ,2.65,2.28},
{0.78,1.25,2.15,3.6 ,4.75,5.75,4.6 ,3.75,3.18,2.62,2.25,1.92},
{0   ,0.8 ,1.75,3.2 ,4.3 ,5.25,4.23,3.35,2.75,2.3 ,1.85,1.6 },
{0   ,0.42,1.4 ,2.5 ,3.8 ,4.77,3.75,3.  ,2.4 ,2.  ,1.6 ,1.28},
{0   ,0   ,0.97,2.25,3.5 ,4.4 ,3.36,2.65,2.1 ,1.62,1.25,0.9 },
{0   ,0   ,0.5 ,2.  ,3.3 ,4.  ,3.  ,2.25,1.73,1.25,0.8 ,0.65}
};

return sol_SS(ns,12,9,ss,alphs,temps);
}

static double S9(int ns)
{
double ss[][ANM]={
	{1.15,1.75,2.25,3.2 ,3.85,4.47,5.  ,5.48,5.9 ,6.25},
	{0.7 ,1.23,1.75,2.7 ,3.45,4.03,4.65,5.05,5.5 ,5.8 },
	{0.2 ,0.75,1.3 ,2.25,3.  ,3.65,4.2 ,4.65,5.1 ,5.48},
	{0.  ,0.4 ,0.9 ,1.75,2.5 ,3.1 ,3.6 ,4.05,4.5 ,4.85}
	};
double alphs[]={.2,.25,.3,.4,.5,.6,.7,.8,.9,1};
double temps[]={800,1000,1200,1400};

return sol_SS(ns,10,4,ss,alphs,temps);

}

static double S10(int ns)
{ /* О2ж + спирт */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.2 ,1.4 ,1.6 ,1.8 ,2.  };
double ss[][ANM]={
{1.96,3.5 ,5.5 ,7.2 ,8.5 ,7.7 ,6.9 ,6.3 ,5.8 ,5.35},
{1.7 ,3.  ,5.2 ,6.8 ,8.25,7.4 ,6.65,6.05,5.5 ,5.1 },
{1.4 ,2.7 ,4.85,6.55,8.  ,7.1 ,6.35,5.78,5.28,4.85},
{1.1 ,2.4 ,4.55,6.27,7.72,6.85,6.2 ,5.56,5.08,4.6 },
{0.8 ,2.1 ,4.28,6.  ,7.47,6.6 ,5.9 ,5.3 ,4.86,4.36},
{0.6 ,1.78,4.  ,5.75,7.22,6.35,5.7 ,5.15,4.62,4.22},
{0.4 ,1.5 ,3.75,5.48,6.9 ,6.1 ,5.45,4.85,4.45,3.95},
{0.15,1.25,3.5 ,5.2 ,6.65,5.8 ,5.22,4.7 ,4.22,3.8 },
{0   ,1.  ,3.25,4.9 ,6.35,5.6 ,4.95,4.4 ,4.  ,3.6 },
{0   ,0.75,3.  ,4.7 ,6.2 ,5.35,4.72,4.2 ,3.75,3.4 },
{0   ,0.51,2.75,4.5 ,5.8 ,5.15,4.5 ,3.95,3.5 ,3.2 }
};

return sol_SS(ns,10,11,ss,alphs,temps);
}

static double S11(int ns)
{ /* О2ж + керосин */
double temps[]={500,600,800,1000,1200,1400,1600,1800,2000};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.2 ,1.4 ,1.6 ,1.8 ,2.  ,2.2 ,2.4 ,2.6 ,2.8 };
double ss[][ANM]={
{2.74,2.75,3.6 ,6.15,8.2 ,10.1,8.75,7.8 ,7.  ,6.4 ,5.85,5.45,5.  ,4.7 ,4.4 },
{2.35,2.5 ,3.4 ,5.85,7.9 ,9.75,8.5 ,7.6 ,6.78,6.15,5.65,5.2 ,4.75,4.4 ,4.15},
{1.65,1.97,2.9 ,5.4 ,7.42,9.24,8.  ,7.1 ,6.28,5.7 ,5.15,4.65,4.3 ,3.97,3.65},
{1.06,1.5 ,2.42,4.9 ,6.92,8.74,7.5 ,6.65,5.85,5.2 ,4.7 ,4.25,3.9 ,3.58,3.25},
{0.5 ,1.12,2.  ,4.48,6.45,8.23,7.  ,6.15,5.4 ,4.75,4.28,3.85,3.5 ,3.22,2.85},
{0   ,0.6 ,1.55,4.15,5.95,7.74,6.6 ,5.7 ,5.  ,4.3 ,3.85,3.4 ,3.15,2.78,2.5 },
{0   ,0   ,0.8 ,3.65,5.5 ,7.25,6.15,5.25,4.5 ,3.9 ,3.42,3.1 ,2.65,2.4 ,2.15},
{0   ,0   ,0.5 ,3.2 ,5.1 ,6.75,5.7 ,4.75,4.1 ,3.5 ,3.1 ,2.65,2.35,2.08,1.8 },
{0   ,0   ,0.25,2.75,4.6 ,6.25,5.25,4.35,3.75,3.2 ,2.75,2.35,2.  ,1.75,1.5 }
};

return sol_SS(ns,15,9,ss,alphs,temps);
}

static double S12(int ns)
{ /* О2ж + C1H4 */
double temps[]={600,800,1000,1200,1400,1600};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.5 ,0.6 ,0.7 ,0.8 ,0.9 ,1. ,1.1};
double ss[][ANM]={
{3.72, 4.84, 5.56, 6.19, 6.73, 7.22, 7.68, 8.10, 8.47, 7.94},
{3.01, 4.19, 5.01, 5.72, 6.33, 6.87, 7.35, 7.80, 8.25, 7.71},
{1.77, 3.02, 3.93, 4.75, 5.45, 6.09, 6.68, 7.29, 7.92, 7.39},
{0.00, 0.97, 2.15, 3.26, 4.28, 5.22, 6.09, 6.86, 7.55, 7.01},
{0.00, 0.00, 1.05, 2.48, 3.70, 4.74, 5.64, 6.43, 7.14, 6.61},
{0.00, 0.00, 0.54, 2.01, 3.24, 4.29, 5.20, 6.00, 6.71, 6.19}
};
return sol_SS(ns,7,6,ss,alphs,temps);
}

static double S13(int ns)
{ /* О2ж +  керосин */
double temps[]={600,800,1000,1200,1400,1600};
double alphs[]=
{0.4 ,0.6 ,0.8 ,1.  ,1.2 ,1.4 ,1.5};
double ss[][ANM]={
{4.  ,6.8 ,8.9 ,10.4,9.05,7.95,7.6 },
{3.5 ,6.2 ,8.30,9.7 ,8.5 ,7.50,7.15},
{3.  ,5.65,7.75,9.27,8.  ,7.  ,6.7 },
{2.60,5.05,7.22,8.75,7.5 ,6.55,6.25},
{2.2 ,4.7 ,6.72,8.25,7.15,6.2 ,5.78},
{1.77,4.25,6.2 ,7.75,6.6 ,5.70,5.3 }
};
return sol_SS(ns,7,6,ss,alphs,temps);
}

static double S14(int ns)
{ /* О2ж +  НДМГ */
double temps[]={500,600,700,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.15,0.2 ,0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.2 ,1.4 ,1.6 ,1.8 ,2. };
double ss[][ANM]={
{1.8 ,2.25,3.  ,4.5 ,6.7 ,8.15,9.5 ,8.45,7.25,6.85,6.35,5.85},
{1.5 ,2.  ,2.72,4.2 ,6.3 ,7.8 ,9.2 ,8.2 ,7.  ,6.7 ,6.05,5.65},
{1.3 ,1.65,2.49,3.8 ,6.  ,7.5 ,8.9 ,7.9 ,6.75,6.4 ,5.85,5.4 },
{1.  ,1.47,2.24,3.5 ,5.72,7.25,8.65,7.72,6.5 ,6.2 ,5.7 ,5.25},
{0.8 ,1.22,1.99,3.25,5.4 ,7.0 ,8.36,7.4 ,6.25,5.95,5.4 ,4.95},
{0.65,0.98,1.75,2.95,5.15,6.7 ,8.15,7.15,6.  ,5.75,5.2 ,4.75},
{0.4 ,0.75,1.5 ,2.72,4.8 ,6.4 ,7.8 ,6.9 ,5.78,5.5 ,4.95,4.5 },
{0.2 ,0.5 ,1.25,2.5 ,4.55,6.2 ,7.6 ,6.65,5.55,5.25,4.75,4.3 },
{0   ,0   ,1.05,2.25,4.3 ,5.9 ,7.3 ,6.4 ,5.35,5.  ,4.5 ,4.15},
{0   ,0   ,0.85,2.  ,4.1 ,5.6 ,7.1 ,6.2 ,5.1 ,4.75,4.25,3.5 },
{0   ,0   ,0.7 ,1.8 ,3.8 ,5.4 ,6.8 ,5.9 ,4.8 ,4.55,4.08,3.75}
};

return sol_SS(ns,12,11,ss,alphs,temps);
}

static double S15(int ns)
{ /* О2ж + H2ж */
double temps[]={600,700,800,1000,1200,1400,1600,1800,2000};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.5 ,0.6 ,0.8 ,1.  ,1.3 ,1.6 ,1.9 ,2.2 ,2.5 ,2.8 ,3.};
double ss[][ANM]={
{3.5 ,5.0 ,6.2 ,7.  ,7.9 ,9.28,10.5,9.1 ,7.28,6.35,5.7 ,5.  ,4.55,4.3 },
{3.1 ,4.6 ,5.75,6.75,7.5 ,8.99,10.2,8.27,7.  ,6.2 ,5.4 ,4.75,4.25,4.1 },
{2.75,4.25,5.45,6.4 ,7.23,8.65,9.75,8.  ,6.75,5.85,5.2 ,4.5 ,4.1 ,3.8 },
{1.75,3.5 ,4.75,5.75,6.55,8.  ,9.15,7.5 ,6.25,5.35,4.7 ,4.05,3.6 ,3.4 },
{1.05,2.8 ,4.05,5.  ,5.8 ,7.3 ,8.5 ,7.  ,5.75,4.85,4.2 ,3.6 ,3.15,2.97},
{0.4 ,2.16,3.48,4.46,5.25,6.75,7.95,6.4 ,5.25,4.4 ,3.73,3.15,2.7 ,2.56},
{0   ,1.5 ,2.75,3.77,4.75,6.2 ,7.3 ,5.85,4.75,4.  ,3.25,2.7 ,2.3 ,2.2 },
{0   ,0.98,2.2 ,3.25,4.2 ,5.55,6.75,5.35,4.25,3.5 ,2.8 ,2.25,1.9 ,1.8 },
{0   ,0.4 ,1.5 ,2.7 ,3.65,5.  ,6.22,4.8 ,3.78,3.  ,2.4 ,1.85,1.5 ,1.4 }
};

return sol_SS(ns,14,9,ss,alphs,temps);
}
static double S16(int ns)
{ /* F2ж + H2ж */
double temps[]={600,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.1 ,1.2 ,1.4 ,1.6 ,1.8 };
double ss[][ANM]={
{7.35,8.  ,9.2 ,10.0,10.5,9.7 ,9.  ,8.  ,7.  ,6.  },
{6.8 ,7.55,8.75,9.5 ,10. ,9.25,8.55,7.6 ,6.7 ,5.6 },
{6.47,7.25,8.5 ,9.25,9.75,9.  ,8.4 ,7.4 ,6.45,5.4 },
{6.18,7.  ,8.25,9.  ,9.6 ,8.8 ,8.2 ,7.25,6.25,5.25},
{5.91,6.75,8.  ,8.8 ,9.35,8.65,7.95,7.  ,6.05,5.  },
{5.53,6.5 ,7.78,8.6 ,9.2 ,8.4 ,7.72,6.78,5.9 ,4.85},
{5.27,6.25,7.5 ,8.35,8.9 ,8.15,7.5 ,6.6 ,5.75,4.72},
{5.1 ,6.  ,7.35,8.15,8.75,7.9 ,7.35,6.5 ,5.55,4.6 },
{4.8 ,5.75,7.15,7.95,8.55,7.75,7.15,6.3 ,5.4 ,4.45}
};

return sol_SS(ns,10,9,ss,alphs,temps);
}
static double S17(int ns)
{ /*H2O2 + НДМГ */
double temps[]={600,800,900,1000,1100,1200,1300,1400,1500};
double alphs[]=
{0.2 ,0.3 ,0.4 ,0.6 ,0.8 ,1.  ,1.2 ,1.4 ,1.6 ,1.8 ,2.0 };
double ss[][ANM]={
{1.68,2.8 ,3.85,4.8 ,5.55,6.1 ,5.6 ,5.1 ,4.72,4.4 ,4.2 },
{1.2 ,2.35,3.25,4.35,5.  ,5.5 ,5.  ,4.5 ,4.15,3.85,3.7 },
{0.95,2.  ,2.99,4.1 ,4.75,5.25,4.75,4.25,3.85,3.65,3.4 },
{0.7 ,1.75,2.71,3.8 ,4.5 ,4.95,4.5 ,4.05,3.7 ,3.35,3.2 },
{0.4 ,1.48,2.35,3.55,4.22,4.75,4.25,3.75,3.4 ,3.15,2.9 },
{0.04,1.2 ,2.1 ,3.25,3.9,4.5 ,4.  ,3.5 ,3.15 ,2.8 ,2.7 },
{0   ,0   ,1.9 ,3.  ,3.72,4.25,3.75,3.25,2.85,2.65,2.45},
{0   ,0   ,1.73,2.78,3.5 ,4.  ,3.5 ,3.  ,2.7 ,2.4 ,2.25},
{0   ,0   ,1.48,2.6 ,3.25,3.75,3.27,2.8 ,2.45,2.25,2.05}
};

return sol_SS(ns,11,9,ss,alphs,temps);
}

/*---------------------------------------------------------*/
/*         температура ядра в зависимости от номера        */
/*             топливной пары и избытка ок.                */
/*---------------------------------------------------------*/

double Tog(int ii)
{
double a[][ANM]={
/*1*/	{1100,1300,1600,2140,2580,2900,3000,3050,3020,2950,2900},
/*2*/	{1210,1300,1700,2200,2610,2900,3060,3100,3030,3000,2950},
/*3*/	{ 600,1000,1800,2300,2680,2940,3080,3110,3090},
/*4*/	{1340,1600,2070,2450,2740,2950,3080,3100,3080,3050,3000},
/*5*/	{1200,1300,1800,2300,2700,3000,3150,3180,3150,3100,3050},
/*6*/	{1250,1350,1800,2400,2800,3040,3150,3200,3150,3110,3080},
/*7*/	{1400,1950,2400,2720,3000,3200,3300,3310,3300,3280,3220,3100,3000,2900,2780},
/*8*/	{1500,1800,2300,2700,3010,3220,3350,3380,3350,3300,3250,3120,3000,2900,2800,2550,2350},
/*9*/	{1300,1900,2330,2670,2930,3140,3230,3280,3300},
/*10*/	{800 ,1300,1800,2400,2850,3180,3300,3340,3380,3340,3310,3150,3080,3030,3000},
/*11*/	{800 ,1400,2200,2920,3680,3750,3760,3760,3750,3720,3680,3580,3490,3395,3300,3100,2900},
/*12*/	{1199,1342,1857,2544,3055,3366,3505,3545,3542,3518,3485,3403,3314,3220,3124,2930,2738},
/*13*/	{1500,1700,2700,3280,3600,3720,3750,3740,3720,3700,3660,3580},
/*14*/	{1700,1850,2500,3000,3340,3480,3550,3570,3560,3550,3500,3400,3310,3220,3180},
/*15*/	{1500,2140,2600,2910,3200,3350,3460,3470,3475,3470,3460,3400,3300,3200,3120,3000,2800},
/*16*/	{3100,3400,3780,4100,4350,4500,4630,4720,4750,4755,4750,4600,4200,4000,3500},
/*17*/	{1300,1800,2200,2500,2680,2800,2900,2920,2900,2880,2800,2700,2600,2500,2400}
	};
double alphs[]={0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,
		1.2,1.4,1.6,1.8,2.0,2.4,2.8};
int ns[]={11,11,9,11,11,11,15,17,9,15,17,17,12,15,17,15,15};
double ret;

if(ii)
	ret=cs_sp(ns[i1],alphs,a[i1],Aok1);
else ret=cs_sp(ns[i1],alphs,a[i1],Aok[0]);

if(ret < 500) ret = 500;
if(ret > 5000) ret = 5000;
return ret;
}

/*--------------------------------------------------------------*/
/*          Теплоемкость Ср охладителей от температуры          */
/*--------------------------------------------------------------*/

/* данные для H2, O2, F2 взяты из "Справочника физ. величин,
   с данными методички близко не совпадают! */

double Cp(double T, int i)
{
double a[][13]={
/*01*/	{1775,1765,1755,1745,1735},
/*02*/	{1700,1900,2100,2300},
/*03*/	{1900,1950,2000,2050,2100,2200,2280,2360,2440,2550,2660,2800,2900},
/*04*/	{2150,2180,2230,2290,2340,2400,2490,2580,2700,2830,2960},
/*05*/	{2700,2750,2795,2810,2850,2920,3000,3080,3160,3290,3470,3730,4220},
/*06*/	{1620,1780,1930,2100,2395,2730,3200},
/*07*/	{2870,2902,2940,2970},
/*08*/	{4210,4200,4180,4180,4200,4210,4240,4280,4350,4410,4500},
/*09*/	{1640,1860,2100,2300},
/*10*/	{2190,2206,2215,2222,2234},
/*11*/	{1694, 1687, 1681,1709,1780,1311,1039,957,934,949,1006,1091},
	/* данные по кислороду из методички
	{1700,1760,1960},
	*/
/* по фтору сделана дописка для газообразного состояния */
/*12*/	{1509,1509,1505,1495,1500,1516,1532,  869, 928, 979},
// /*13*/	{2615,2730},
/*13*/	{0,0},
/*14*/	{2300,2400,2600,2800,3020,3300,3600,3940},
/*15*/	{1820,1890,1955,2130,2210},
/*16*/  {2260,2380,2490,2600,2630,2690,2750,2825,2920,3020},
/*17*/  {6800, 9170, 12580, 23260, 12180, 13700, 16140, 14530, 14980, 17330 },
	/* данные по водороду из методички
	{7400,9000}
	*/
	};
double temps[]={233,253,273,293,313,333,353,373,393,413,433,453,473};
/*              -40,-20,0  , 20, 40, 60, 80,100,120,140,160,180,200	*/

int fst[]={0, 1, 0, 2, 0, 2, 2, 2, 1, 0, 0, 0, 0, 2, 2, 3, 0};
int ns[]= {5, 4,13,11,13, 7, 4,11, 4, 5, 3, 7, 2, 8, 5,10, 2};
/*          1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 */

double tt1[]={70,80,90,100,110,120,150,200,300,400,600,1000};
	/* температуры по кислороду из методички
	{83,103,123};
	*/
double tt2[]={53,63,73,83,93,103,113,  400,600,1000};	/* F2ж */
double tt3[]={273,373};			/* H2O2 */
double tt4[]={15,20,25,30,50,100,200,500,1000,2000};	/* H2ж */
	/* температуры по водороду из методички
	{16,21};
	*/

double ret;

switch(i){
	case 10: /*жидкий кислород */
		ret=lin(12,tt1,a[10],T);	/* lin(3,... для метод.*/
		break;
	case 11: /* жидкий фтор */
		ret=lin(7+3,tt2,a[11],T);
		break;
	case 12: /* перекись водорода */
		ret=lin(2,tt3,a[12],T);
		break;
	case 16: /* жидкий водород */
		ret=lin(10,tt4,a[16],T);	/* lin(2, ... для метод. */
		break;

	default:
		ret=cs_sp(ns[i],&temps[fst[i]],a[i],T);
		break;
	}

if(ret < 1400)
	ret = 1400;
if(ret > 24000)
	ret = 24000;

return ret;
}

double Mu(double T, int i)
/* вязкость охладителей, Па*c. В таблице -> * 1e-4 */
/* данные по газам также не совпадают со "Справочником..." */
{
double a[][19]={
/*01*/  {11,8,6},
/*02*/  {120,55,30,20},
/*03*/  {120,36,21,15,10,8.7,7.5,6.2,5,5,5},
/*04*/  {200,32,17,10,7.5,5,5,5},
/*05*/  {23,12,7.5,5.6,4,3.3,2.5,2,1.8,1.5,1},
/*06*/  {5.3,4.2,3.3,2.6,2.,1.5,1.,0.6},
/*07*/  {13,8.8,6.5,5},
/*08*/  {18,10,6.8,4.8,3.6,2.9,2.4,2.,1.8,1.6,1.5},
/*09*/  {95,45,23,15,10},
/*10*/  {72,25,13,9,8},
/*11*/  {2.4,1.1,0.4,0.3},
/*12*/  {4.4,2.6,2.58},
/*13*/  {18.2,12.8,9.3,7.2,5.8,4.9,4.4,3.9},
/*14*/  {28,18,12,8.3,6.,4.4,3.2,2.6,2.,1.6,1.1,1.},
/*15*/  {140,60,30,20,14,10,8,7.5},
/*16*/  {215,85,40,24,16,12,10,9,8,7,6,5,4.5},
/*17*/  {0.235,0.17,0.132,0.064,	/* дальше - газ */
		0.0291,0.036,0.0421,0.0557,.0678,.079,.0894,.109,
		.127,.145,.177,.207,.276,.336}
	};
double temps[]={233,253,273,293,313,333,353,373,393,413,433,453,473};
/*              -40,-20, 0 , 20, 40, 60, 80,100,120,140,160,180,200 */
int fst[]={ 2, 0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 2, 1, 0, 0, 0};
int ns[]= { 3, 4,11, 8,11, 4, 8,11, 5, 5, 4, 3, 8,12, 8,13, 18};
/*          1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 */

/*	кислород	*/
double tt1[]={93,123,153,173};
/*	фтор	*/
double tt2[]={68,83,88};
/*	водород		*/
double tt4[]={15,18,21,30,60,80,100,150,200,250,300,400,500,600,800,1000,1500,2000};

double ret;

switch(i){
	case 10: /*жидкий кислород */
		ret=lin(4,tt1,a[10],T);
		break;
	case 11: /* жидкий фтор */
		ret=lin(3,tt2,a[11],T);
		break;
	case 16: /* жидкий водород */
		ret=lin(17,tt4,a[16],T);
		break;

	default:
                ret= cs_sp(ns[i],&temps[fst[i]],a[i],T);
                break;
        }
if(ret < 0.01)
	ret = 0.01;
if(ret > 250)
	ret = 250;
ret/=1e4;
return ret;
}

/*-----------------------------------------------*/
/*  Теплопроводность охладителя от температуры   */
/*    T - температура, i - номер охладителя      */
/*-----------------------------------------------*/

double Lam(double T, int i)
{
double ret;
double a[][3]={
/*01*/  {0.119,-4.7619e-4},
/*02*/  {-0.2428,1.75e-3},
/*03*/  {0.159,-1.4583e-4},
/*04*/  {0.1819,-1.7143e-4},
/*05*/  {0.266,2.86e-4},
/*06*/  {0.1962,-1.8333e-4},
/*07*/  {0.254},
/*08*/  {-0.4989,5.8286e-3,-7.1429e-6},
/*09*/  {-2.05,1.6e-3},
/*10*/  {0.26},
/*11*/  {0.2573,-1.2286e-3},
// /*12*/  {0.1},	/* от фонаря: найти в справочниках не удалось! */
/*12*/  {2.14917366e-60, -2.51570909e-56,  1.21912430e-52, -2.94617337e-49, 2.72286030e-46,  3.20325980e-43, -9.66110981e-40,  8.19859293e-38, 2.34918950e-33, -2.64535023e-30, -2.76776836e-27,  1.14577849e-23, -1.66434743e-20,  1.49500743e-17, -9.24786687e-15,  4.06693747e-12, -1.27387637e-09,  2.79131554e-07, -4.11977494e-05,  3.83981006e-03, -2.02433667e-01,  4.79346268e+00} /* хе-хе-хе-ха --> https://www.youtube.com/watch?v=9Nskc3bF6FU&pp=ygULaGUtaGUtaGUtaGE%3D */
/*13*/  {-0.3808,5.1e-3,-6.3929e-6},
/*14*/  {9.5471e-2,5.46e-4,-1e-6},
/*15*/  {0.1637,-8.6364e-5},
/*16*/  {1.61,-1.333e-3},
/*17*/  {0.0757,0.002143},
/*17a*/	{.015,.00045},		/* газообразный водород */
	};
int nn[]={2,2,2,2,2,2,1,3,2,1,2,22,3,3,2,2,2,2};

if(nn[i]==1) ret=a[i][0];
else
	{
	if(i==16 && T > 20)
		ret = horner(T,2,a[17]);
	else
		 ret=horner(T,nn[i],a[i]);
	}

if(ret > 0.8)
	ret = 0.8;
if( ret < 0.0005)
	ret = 0.0005;

return ret;
}

/*-------------------------------------------------------------*/
/*           Плотность охладителя от температуры               */
/*-------------------------------------------------------------*/

double Ro(double T, int i)
{
double a[][4]={
/*01*/  {2096., -2.},
/*02*/  {2137.475, -1.825},
/*03*/  {1025.231, -0.7179487},
/*04*/  {1066.427, -0.7142857},
/*05*/  {1053.538, -0.923077},
/*06*/  {1935.835, -1.813733},
/*07*/  {1162.667,-0.888889},
/*08*/  {600,1.8596,2.1116e-3,-1.30522e-5},
/*09*/  {2011.321, -1.9},
/*10*/  {1156.538, -0.961539},
/*11*/  {1052.522, 6.332216, -5.889572e-2},
/*12*/  {6.74586977e-57, -7.95298733e-53,  3.88694576e-49, -9.50148317e-46,9.01026768e-43,  1.00465958e-39, -3.16883401e-36,  3.93326953e-34,7.65534010e-30, -9.00230982e-27, -8.68802488e-24,  3.81087220e-20,-5.65706202e-17,  5.17830476e-14, -3.26588652e-11,  1.46694684e-08,-4.70581614e-06,  1.05980752e-03, -1.61446972e-01,  1.55841629e+01,-8.48152704e+02,  2.00536388e+04}, /* в дом Ивангая летит ракета пока ты считаешь движок на метане СТОП ВАР */ 
/*13*/  {500.1642, 9.984552, -3.184647e-2, 2.978413e-5},
/*14*/  {1184.153,-2.721533,7.571433e-3,-9.786622e-6},
/*15*/  {1036.727,-0.7272727},
/*16*/  {1044,    -0.7272727},
/*17*/  {71.03008, 1.197575, -5.844328e-2},         /* жидкий */
/*17a*/	{20.} 		/* газообразный при НУ */
	};

int nn[] = {
/*01*/  2,
/*02*/  2,
/*03*/  2,
/*04*/  2,
/*05*/  2,
/*06*/  2,
/*07*/  2,
/*08*/  4,
/*09*/  2,
/*10*/  2,
/*11*/  3,
/*12*/  22, /* делайте анжуманя по утрам */
/*13*/  4,
/*14*/  4,
/*15*/  2,
/*16*/  2,
/*17*/  3
	};

if(i==16 && T > 20)
	return a[17][0];

return horner(T,nn[i],a[i]);
}


/*----------------------------------------------------------------------*/
/*  теплопроводность материала стенок и пористой вставки от температуры */
/*             X - температура, JN - номер материала                    */
/*----------------------------------------------------------------------*/

/*0 -	ВТ-00	*/
/*1 -	Тi-сплав */
/*2 -	12X18H10T */
/*3 -	08X17H5M3 */
/*4 -	2X18H12C4TЮ */
/*5 -	БрХ-08 */
/*6 -	W-сплав */
/*7 - 	Ni-сплав */
/*8 -	Nb-сплав */

double Ela(double X, int JN)
{
double ELR=-1000.;
	switch(JN+1){
		case 1:if(X >= 573.)ELR=18.; else ELR=20.865-0.005*X; break;
		case 2: ELR=4.455+0.013*X;break;
		case 3: ELR=11.2+0.0123523*X;break;	/*верно 10:22am 10-26-1995 */
		case 4: ELR=12.4+0.015*X;break;
		case 5: ELR=8.+0.015*X;break;
		case 6: ELR=53.107+0.6*X-3.4375E-4*(X*X);break;
		case 7: ELR=188.34-0.1162*X+3.595E-5*(X*X);break;
		case 8: ELR=10.54+0.02*X;break;
		case 9: ELR=45.55+0.0226*X;break;
		}
if(ELR > 350.) ELR=350.;
else if(ELR < 8.) ELR = 8.;
return ELR;
}

